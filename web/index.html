<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bato sur lô</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/maplibre-gl@^5.6.0/dist/maplibre-gl.js"></script>
    <link
      href="https://unpkg.com/maplibre-gl@^5.6.0/dist/maplibre-gl.css"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/visu.css" />

    <script src="js/ajax.js"></script>
    <script src="js/requests.js"></script>

    <link rel="icon" type="image/png" href="images/crabe.png" />
  </head>
  <body>
    <div
      id="errors"
      style="
        display: none;
        position: fixed;
        top: 50px;
        right: 20px;
        background: #f44336;
        color: white;
        padding: 15px;
        border-radius: 5px;
        z-index: 1000;
      "
    ></div>

    <header class="header">
      <div class="nav-container">
        <div class="logo">
          <img
            src="images/crabe.png"
            alt="Logo Crabe"
            class="logo-img"
            style="height: 32px; vertical-align: middle; margin-right: 8px"
          />
          Bato sur lô
        </div>
        <nav>
          <ul class="nav-menu">
            <li>
              <a href="#" class="nav-link active" data-page="home">Accueil</a>
            </li>
            <li>
              <a href="#" class="nav-link" data-page="add">Ajout de données AIS</a>
            </li>
            <li>
              <a href="#" class="nav-link" data-page="visualize">Visualiser</a>
            </li>
            <li>
              <a href="#" class="nav-link" data-page="clusters">Clusters</a>
            </li>
            <li>
              <a href="#" class="nav-link" data-page="predict">Prédictions</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <section id="home-page" class="content-page active">
      <div class="parallax-container">
        <div class="parallax-scene">
          <div class="stars-layer"></div>
          <div class="earth-container">
            <canvas id="globe-canvas"></canvas>
            <div class="earth-glow"></div>
          </div>
          <div class="welcome-content">
            <h1 class="main-title">
              <span class="title-line">BATO</span>
              <span class="title-line">SUR LÔ</span>
            </h1>
            <p class="subtitle">groupe 2</p>
            <div class="scroll-indicator">
              <span>Scrollez pour explorer</span>
              <div class="arrow-down"></div>
            </div>
          </div>
        </div>

        <div class="intro-content">
          <div class="intro-section">
            <h2>Projet de fin d'année</h2>
            <p>
              Analyse des comportements de navigation des navires à partir des
              données AIS du Golfe du Mexique.
            </p>

            <div class="features-grid">
              <div class="feature-card" data-page="add">
                <h3>Ajout de données AIS</h3>
                <p>
                  Enregistrez de nouveaux points de données AIS et navires dans la base
                </p>
              </div>
              <div class="feature-card" data-page="visualize">
                <h3>Visualiser</h3>
                <p>Consultez les navires en tableau et sur carte interactive</p>
              </div>
              <div class="feature-card" data-page="clusters">
                <h3>Clusters</h3>
                <p>Analyse des comportements de navigation similaires</p>
              </div>
              <div class="feature-card" data-page="predict">
                <h3>Prédictions IA</h3>
                <p>Prédiction du type et de la trajectoire des navires</p>
              </div>
            </div>

            <div class="cta-section">
              <a href="#" class="cta-button" data-page="visualize"
                >Commencer l'exploration</a
              >
              <div
                style="
                  display: flex;
                  justify-content: center;
                  gap: 40px;
                  margin: 70px 0;
                "
              >
                <img
                  src="images/bateau.png"
                  alt="image demandé sur la page d'accueil"
                  style="height: 120px"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="add-page" class="content-page">
      <div class="page-container">
        <div class="mode-selector">
          <button id="vessel-mode-btn" class="mode-btn active" data-mode="vessel">
            Navire
          </button>
          <button id="point-mode-btn" class="mode-btn" data-mode="point">
            Point de données
          </button>
        </div>

        <div id="vessel-section" class="form-section active">
          <h1 class="page-title" style="text-align: center;">Ajouter un navire</h1>
          <p class="form-description" style="text-align: center;">
              Ajoutez un nouveau navire à la base de donnée du site pour ajouter des points de données.
          </p>
          <form id="add-vessel-form" class="form-container">
            <p class="required-note">Tous les champs sont obligatoires</p>
            <div class="form-group">
              <label for="mmsi">MMSI</label>
              <input type="text" id="mmsi" name="mmsi" class="form-input" required placeholder="ex: 205874000"/>
            </div>
            <div class="form-group">
              <label for="vesselname">Nom du Navire</label>
              <input type="text" id="vesselname" name="vesselname" class="form-input" required placeholder="ex: HOLLANDAIS VOLANT"/>
            </div>
            <div class="form-group">
              <label for="imo">IMO</label>
              <input type="text" id="imo" name="imo" class="form-input" required placeholder="ex: JK526542"/>
            </div>
            <div class="form-group">
              <label for="callsign">Callsign</label>
              <input type="text" id="callsign" name="callsign" class="form-input" required placeholder="ex: MS56231"/>
            </div>
            <div class="form-group">
              <label for="transceiverclass">Classe de transpondeur</label>
              <select id="transceiverclass" name="transceiverclass" class="form-select" required>
                <option value="">Sélectionnez</option>
                <option value="A">A</option>
                <option value="B">B</option>
              </select>
            </div>
            <div class="form-group">
              <label for="length">Longueur (m)</label>
              <input type="number" id="length" name="length" class="form-input" required placeholder="ex: 60" min="0"/>
            </div>
            <div class="form-group">
              <label for="width">Largeur (m)</label>
              <input type="number" id="width" name="width" class="form-input" required placeholder="ex: 22" min="0"/>
            </div>

            <button type="submit" class="btn-primary" style="margin-top: 30px;">Ajouter le navire</button>
            <div id="vessel-form-message" class="form-message"></div>
          </form>
        </div>

        <div id="point-section" class="form-section">
          <h1 class="page-title">Ajouter un point de données</h1>
          <p class="form-description" style="text-align: center;">
              Ajoutez un nouveau point de données de tracking maritime avec les informations de position et de navigation.
          </p>
          
          <form id="add-point-form" class="form-container">
              <p class="required-note">Tous les champs sont obligatoires</p>
              
              <div class="form-group">
                  <label for="point-mmsi">MMSI</label>
                  <input type="text" id="point-mmsi" name="mmsi" class="form-input" required placeholder="ex: 123456789" maxlength="9" />
              </div>
              <div class="form-group">
                  <label for="base_date_time">Date et Heure</label>
                  <input type="datetime-local" id="base_date_time" name="base_date_time" class="form-input" required />
              </div>
              <div class="form-group">
                  <label for="latitude">Latitude</label>
                  <input type="number" id="latitude" name="latitude" class="form-input" required step="0.000001" min="-90" max="90" placeholder="ex: 48.8566" />
              </div>
              <div class="form-group">
                  <label for="longitude">Longitude</label>
                  <input type="number" id="longitude" name="longitude" class="form-input" required step="0.000001" min="-180" max="180" placeholder="ex: 2.3522" />
              </div>
              <div class="form-group">
                  <label for="sog">SOG (Speed Over Ground)</label>
                  <input type="number" id="sog" name="sog" class="form-input" required step="0.1" min="0" max="102.3" placeholder="Vitesse en nœuds" />
              </div>
              <div class="form-group">
                  <label for="cog">COG (Course Over Ground)</label>
                  <input type="number" id="cog" name="cog" class="form-input" required step="0.1" min="0" max="359.9" placeholder="Cap en degrés" />
              </div>
              <div class="form-group">
                  <label for="heading">Heading (Cap)</label>
                  <input type="number" id="heading" name="heading" class="form-input" required step="1" min="0" max="359" placeholder="Cap en degrés" />
              </div>
              <div class="form-group">
                  <label for="status_code">Code de Status</label>
                  <select id="status_code" name="status_code" class="form-select" required>
                      <option value="">Sélectionnez</option>
                      <option value="0">En route avec moteur</option>
                      <option value="1">Ancré</option>
                      <option value="2">Non manoeuvrable</option>
                      <option value="3">Manoeuvre restreinte</option>
                      <option value="4">Contraint par son tirant d'eau</option>
                      <option value="5">Amarré</option>
                      <option value="6">Échoué</option>
                      <option value="7">Pêche</option>
                      <option value="8">En route à la voile</option>
                      <option value="9">Réservé pour amendement futur (DG/HS/MP, HSC)</option>
                      <option value="10">Réservé pour amendement futur (DG/HS/MP, WIG)</option>
                      <option value="11">Réservé pour usage futur</option>
                      <option value="12">Réservé pour usage futur</option>
                      <option value="13">Réservé pour usage futur</option>
                      <option value="14">Réservé pour usage futur</option>
                      <option value="15">Non défini = par défaut</option>
                  </select>
              </div>
              <div class="form-group">
                  <label for="draft">Tirant d'Eau (m)</label>
                  <input type="number" id="draft" name="draft" class="form-input" required step="0.1" min="0" max="25.5" placeholder="Tirant d'eau en mètres" />
              </div>

              <button type="submit" class="btn-primary" id="submit-btn" style="margin-top: 10px;">
                  <span class="loading-spinner"></span>
                  <span class="btn-text">Ajouter le point de données</span>
              </button>
              <div id="point-form-message" class="form-message"></div>
          </form>
        </div>
      </div>
    </section>


    <section id="visualize-page" class="content-page">
      <div class="page-container">
        <h1 class="page-title">Visualisation des Navires</h1>
        <p class="page-description">
          Liste des points de données AIS de la base de données
        </p>

        <div class="filters-container">
          <div class="filter-group">
            <label for="filter-longueur">Longueur:</label>
            <div class="range-slider" data-min="0" data-max="500" data-step="1">
              <input
                type="range"
                id="filter-longueur-min"
                class="range-min"
                min="0"
                max="500"
                value="0"
                step="1"
              />
              <input
                type="range"
                id="filter-longueur-max"
                class="range-max"
                min="0"
                max="1000"
                value="500"
                step="1"
              />
              <div class="range-track"></div>
              <div class="range-values">
                <span id="longueur-min-val">0</span> -
                <span id="longueur-max-val">500</span>
              </div>
            </div>
          </div>

          <div class="filter-group">
            <label for="filter-largeur">Largeur:</label>
            <div class="range-slider" data-min="0" data-max="100" data-step="1">
              <input
                type="range"
                id="filter-largeur-min"
                class="range-min"
                min="0"
                max="100"
                value="0"
                step="1"
              />
              <input
                type="range"
                id="filter-largeur-max"
                class="range-max"
                min="0"
                max="10000"
                value="100"
                step="1"
              />
              <div class="range-track"></div>
              <div class="range-values">
                <span id="largeur-min-val">0</span> -
                <span id="largeur-max-val">100</span>
              </div>
            </div>
          </div>

          <div class="filter-group">
            <label for="filter-temps">Période:</label>
            <div
              class="range-slider date-range"
              data-min="0"
              data-max="100"
              data-step="1"
            >
              <input
                type="range"
                id="filter-temps-min"
                class="range-min"
                min="0"
                max="100"
                value="0"
                step="1"
              />
              <input
                type="range"
                id="filter-temps-max"
                class="range-max"
                min="0"
                max="100"
                value="100"
                step="1"
              />
              <div class="range-track"></div>
              <div class="range-values">
                <span id="temps-min-val">--/--/----</span> -
                <span id="temps-max-val">--/--/----</span>
              </div>
            </div>
          </div>

          <div class="filter-group">
            <label for="filter-transceiver">Transceiver Class:</label>
            <select id="filter-transceiver" class="form-select">
              <option value="">Tous</option>
            </select>
          </div>

          <div class="filter-group">
            <label for="filter-mmsi">MMSI:</label>
            <input
              type="text"
              id="filter-mmsi"
              class="form-input"
              placeholder="Rechercher MMSI..."
            />
          </div>

          <div class="filter-group">
            <label for="filter-status">Status Code:</label>
            <select id="filter-status" class="form-select">
              <option value="">Tous les status</option>
            </select>
          </div>

          <button id="filter-button" class="btn-secondary">
            Appliquer filtres
          </button>
          <button id="reset-button" class="btn-secondary">Réinitialiser</button>
        </div>

        <div
          class="pagination-container"
          style="
            margin: 20px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
          "
        >
          <div class="pagination-info">
            <span id="pagination-info-text"
              >Page 1 / 1 (0 résultats au total)</span
            >
          </div>
          <div
            class="pagination-controls"
            style="
              display: flex;
              align-items: center;
              gap: 10px;
              flex-wrap: wrap;
            "
          >
            <div style="display: flex; align-items: center; gap: 5px">
              <label for="items-per-page">Éléments par page:</label>
              <select
                id="items-per-page"
                class="form-select"
                style="width: auto"
              >
                <option value="10" selected>10</option>
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="100">100</option>
              </select>
            </div>
            <div style="display: flex; gap: 5px">
              <button id="prev-page" class="btn-secondary" disabled>
                Précédent
              </button>
              <button id="next-page" class="btn-secondary">Suivant</button>
            </div>
          </div>
        </div>

        <div class="table-container">
          <table class="data-table" id="vessels-table">
            <thead>
              <tr>
                <th>Sélection</th>
                <th>MMSI</th>
                <th>Date/Heure</th>
                <th>Latitude</th>
                <th>Longitude</th>
                <th>SOG</th>
                <th>COG</th>
                <th>Heading</th>
                <th>Status Code</th>
                <th>Draft</th>
                <th>Transceiver</th>
                <th>Length</th>
                <th>Width</th>
                
              </tr>
            </thead>
            <tbody id="vessels-tbody">
              <tr>
                <td colspan="10" class="placeholder-text">
                  Chargement des données...
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="map-container" id="vessels-map">
          <div class="placeholder-text">Super carte<br /></div>
        </div>

        <div class="action-buttons">
          <button class="btn-secondary" onclick="refreshVisualization()">
            Actualiser
          </button>
          <button class="btn-primary" onclick="predictClusters()">
            Prédire les clusters
          </button>
          <button class="btn-primary" onclick="predictSelected('type')">
            Prédire le type
          </button>
          <button class="btn-primary" onclick="predictSelected('trajectory')">
            Prédire la trajectoire
          </button>
          <button class="btn-secondary" onclick="exportData()">
            Exporter données
          </button>
        </div>
      </div>
    </section>

    <section id="clusters-page" class="content-page">
      <div class="page-container">
        <h1>Analyse des Clusters</h1>

        <div class="map-container" id="clusters-map">
          <div class="placeholder-text">Super carte<br /></div>
        </div>

      </div>
    </section>

    <section id="predict-page" class="content-page">
      <div class="page-container">
        <h1>Prédictions IA</h1>

        <div class="map-container" id="predict-map">
          <div class="placeholder-text">Super carte<br /></div>
        </div>

      </div>
    </section>

    <footer class="footer">
      <p>&copy; 2025 Projet A3 - groupe 2 - Bato sur lô</p>
    </footer>

    <script src="js/script.js"></script>
    <script src="./js/map.js"></script>
  </body>
</html>
